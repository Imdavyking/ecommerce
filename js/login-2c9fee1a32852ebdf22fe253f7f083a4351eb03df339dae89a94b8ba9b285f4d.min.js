function asyncGeneratorStep(e,t,n,r,i,o,s){try{var a=e[o](s),c=a.value}catch(e){return void n(e)}a.done?t(c):Promise.resolve(c).then(r,i)}function _asyncToGenerator(a){return function(){var e=this,s=arguments;return new Promise(function(t,n){var r=a.apply(e,s);function i(e){asyncGeneratorStep(r,t,n,i,o,"next",e)}function o(e){asyncGeneratorStep(r,t,n,i,o,"throw",e)}i(void 0)})}}var sign_in_btn=document.querySelector("#sign-in-btn"),sign_up_btn=document.querySelector("#sign-up-btn"),container=document.querySelector(".container"),signupForm=document.querySelector(".sign-up-form"),signinForm=document.querySelector(".sign-in-form"),phoneInputField=document.querySelector("#phone"),cacheBuster=JSON.parse(document.querySelector("#cache-busting-images").innerText),phoneInput=window.intlTelInput(phoneInputField,{utilsScript:"/js/utils.js"});sign_up_btn.addEventListener("click",function(){container.classList.add("sign-up-mode")}),sign_in_btn.addEventListener("click",function(){container.classList.remove("sign-up-mode")}),signinForm.addEventListener("submit",function(){var t=_asyncToGenerator(regeneratorRuntime.mark(function e(t){var n,r,i,o,s,a,c,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),n=t.target.querySelector("button[type=submit]"),r=n.innerText,n.innerHTML="<img src='".concat(cacheBuster["/img/loading.gif"],"' id='loading_network'>"),i={email:document.querySelector("[name='signIn-email']").value,password:document.querySelector("[name='signIn-password']").value,csrfToken:document.querySelector("[id='csrf_token']").getAttribute("content")},e.next=7,fetch("/api/userEmailExists",{credentials:"same-origin",method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:i.email.trim(),csrfToken:document.querySelector("[id='csrf_token']").getAttribute("content")})});case 7:return o=e.sent,e.next=10,o.json();case 10:if(s=e.sent,a=!0,Object.values(i).forEach(function(e){""===e.trim()&&(a=!1)}),s.exists){e.next=18;break}swal({title:"Error while Signing In",text:"Email not registered",icon:"error"}),n.innerText=r,e.next=30;break;case 18:if(a){e.next=23;break}swal({title:"Form not fully filled",text:"Please fill all fields!",icon:"error"}),n.innerText=r,e.next=30;break;case 23:return e.next=25,fetch("/api/login",{method:"POST",headers:{"Content-Type":"application/json","X-Action":"login"},credentials:"same-origin",body:JSON.stringify(i)});case 25:return c=e.sent,e.next=28,c.json();case 28:"success"===(u=e.sent).status?window.location="/":(swal({title:"Error while Signing In",text:u.error,icon:"error"}),n.innerText=r);case 30:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}}()),signupForm.addEventListener("submit",function(){var t=_asyncToGenerator(regeneratorRuntime.mark(function e(t){var n,r,i,o,s,a,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),n=t.target.querySelector("button[type=submit]"),r=n.innerText,n.innerHTML="<img src='".concat(cacheBuster["/img/loading.gif"],"' id='loading_network'>"),i={userName:document.querySelector("[name='signUp-username']").value,email:document.querySelector("[name='signUp-email']").value,phone:phoneInput.getNumber(),password:document.querySelector("[name='signUp-password-one']").value,passoword2:document.querySelector("[name='signUp-password-two']").value,csrfToken:document.querySelector("[id='csrf_token']").getAttribute("content")},o=!0,Object.values(i).forEach(function(e){""===e.trim()&&(o=!1)}),e.next=9,fetch("/api/userEmailExists",{credentials:"same-origin",method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:i.email.trim(),csrfToken:document.querySelector("[id='csrf_token']").getAttribute("content")})});case 9:return s=e.sent,e.next=12,s.json();case 12:if(!e.sent.exists){e.next=18;break}swal({title:"Error while registrating",text:"Email already registered",icon:"error"}),n.innerHTML=r,e.next=46;break;case 18:if(i.password===i.passoword2){e.next=23;break}swal({title:"Error while registrating",text:"Password and Confirmation password do not match",icon:"error"}),n.innerHTML=r,e.next=46;break;case 23:if(!(i.password.length<6)){e.next=28;break}swal({title:"Error while registrating",text:"Password must be six(6) or more characters",icon:"error"}),n.innerHTML=r,e.next=46;break;case 28:if(10===phoneInputField.value.length&&!Number.isNaN(+phoneInputField.value)){e.next=33;break}swal({title:"Error while registrating",text:"Invalid Phone Number",icon:"error"}),n.innerHTML=r,e.next=46;break;case 33:if(o){e.next=38;break}swal({title:"Form not fully filled",text:"Please fill all fields!",icon:"error"}),n.innerHTML=r,e.next=46;break;case 38:if(o)return e.next=41,fetch("/api/login",{method:"POST",headers:{"Content-Type":"application/json","X-Action":"sign-up"},credentials:"same-origin",body:JSON.stringify(i)});e.next=46;break;case 41:return a=e.sent,e.next=44,a.json();case 44:"success"===(c=e.sent).status?(signupForm.querySelectorAll("input").forEach(function(e){return"submit"!=e.type&&(e.value="")}),swal({title:"Email Verification needed",text:"Please check your email to complete verification",icon:"info"}),t.target.querySelector("button[type=submit]").innerHTML=r):(swal({title:"Error while registrating",text:c.error,icon:"error"}),n.innerHTML=r);case 46:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}}());var showPasswordSignUp=document.querySelector(".show-password");showPasswordSignUp.addEventListener("click",function(){return showPasswordSignUp.classList.contains("fa-eye")?(document.querySelector('[name="signIn-password"]').type="text",showPasswordSignUp.classList.remove("fa-eye"),showPasswordSignUp.classList.add("fa-eye-slash")):(document.querySelector('[name="signIn-password"]').type="password",showPasswordSignUp.classList.remove("fa-eye-slash"),showPasswordSignUp.classList.add("fa-eye"))});